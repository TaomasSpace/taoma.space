<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Create Template - TAOMA</title>
    <meta name="description" content="Create Linktree templates for desktop and mobile." />
    <meta property="og:title" content="Create Template - TAOMA" />
    <meta property="og:description" content="Build marketplace templates from your linktree styles." />
    <meta name="theme-color" content="#0f1223" />
    <link rel="icon" type="image/png" href="/static/icon.png" />
  </head>
  <body style="margin:0;padding:0;overflow:hidden;height:100vh">
    <iframe
      src="/linktree/config?hideLinks=true"
      title="Create Template"
      style="border:0;width:100%;height:100vh;display:block"
    ></iframe>
    <button
      id="btnDemo"
      style="
        position: fixed;
        right: 16px;
        bottom: 16px;
        z-index: 50;
        padding: 10px 14px;
        border: 1px solid #ffffff33;
        border-radius: 12px;
        background: #85a3ff;
        color: #fff;
        font-weight: 700;
        cursor: pointer;
        box-shadow: 0 8px 20px rgba(0,0,0,0.25);
      "
    >
      Demo ansehen
    </button>
    <script>
      const iframe = document.querySelector("iframe");
      function stripLinksAndBadges() {
        const doc = iframe.contentDocument || iframe.contentWindow.document;
        if (!doc) return;
        const linkSection = Array.from(doc.querySelectorAll("section.card.panel")).find(
          (sec) => (sec.querySelector("h2") || {}).textContent?.trim().toLowerCase() === "links"
        );
        if (linkSection) linkSection.remove();
        const badges = doc.getElementById("badges");
        if (badges) {
          const hr =
            badges.previousElementSibling &&
            badges.previousElementSibling.classList.contains("hr")
              ? badges.previousElementSibling
              : null;
          const h3 =
            badges.previousElementSibling &&
            badges.previousElementSibling.tagName === "H3"
              ? badges.previousElementSibling
              : badges.parentElement?.querySelector("h3");
          badges.remove();
          if (hr) hr.remove();
          if (h3) h3.remove();
        }
      }
      iframe.addEventListener("load", () => {
        stripLinksAndBadges();
        let attempts = 0;
        const id = setInterval(() => {
          attempts += 1;
          stripLinksAndBadges();
          if (attempts > 5) clearInterval(id);
        }, 500);
      });

      document.getElementById("btnDemo").addEventListener("click", () => {
        try {
          const doc = iframe.contentDocument || iframe.contentWindow.document;
          if (!doc) return;
          const slugInput = doc.getElementById("inSlug");
          const slug = slugInput ? slugInput.value.trim() : "";
          if (!slug) {
            alert("Bitte zuerst einen Slug setzen und speichern.");
            return;
          }
          const formMeta = doc.getElementById("formMeta");
          if (formMeta) {
            formMeta.dispatchEvent(new Event("submit", { cancelable: true, bubbles: true }));
          }
          const url = `/tree/${encodeURIComponent(slug)}`;
          window.open(url, "_blank");
        } catch (e) {
          alert("Demo konnte nicht ge√∂ffnet werden.");
        }
      });
    </script>
  </body>
</html>
