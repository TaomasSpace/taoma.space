<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Anime GIF API - Explorer & Docs</title>
    <style>
      :root {
        --bg: #0e1020;
        --card: #171b3b;
        --ink: #e7e9ff;
        --muted: #a2a9c8;
        --acc: #85a3ff;
        --acc-2: #5b7bff;
        --ok: #35d79c;
        --err: #ff5a6a;
        --ring: #85a3ff55;
        --container: 1100px;
      }

      * {
        box-sizing: border-box;
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu,
          Arial, sans-serif;
      }

      body {
        margin: 0;
        background: var(--bg);
        color: var(--ink);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      body::before {
        content: "";
        position: fixed;
        inset: 0;
        z-index: -1;
        pointer-events: none;
        background: radial-gradient(
            1400px 900px at 12% -8%,
            #1b1f45 0%,
            #1b1f45 35%,
            transparent 72%
          ),
          radial-gradient(
            1200px 700px at 80% 20%,
            #111533 0%,
            #111533 32%,
            transparent 60%
          ),
          linear-gradient(135deg, #0e1020 0%, #0b0d1c 100%);
      }

      header {
        position: sticky;
        top: 0;
        z-index: 50;
        backdrop-filter: saturate(1.1) blur(10px);
        background: linear-gradient(180deg, #0c0f24cc 0%, #0c0f2400 100%);
        border-bottom: 1px solid #ffffff14;
      }

      .container {
        width: min(100%, var(--container));
        margin: 0 auto;
        padding: 0 16px;
      }

      .nav {
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 64px;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-weight: 800;
        letter-spacing: 0.4px;
      }

      .brand .logo {
        width: 28px;
        height: 28px;
        border-radius: 8px;
      }

      .links {
        display: flex;
        gap: 1rem;
        align-items: center;
      }

      .links a {
        padding: 0.45rem 0.7rem;
        border-radius: 10px;
        border: 1px solid transparent;
        color: var(--ink);
        text-decoration: none;
      }

      .links a:hover {
        border-color: #ffffff1f;
        background: #ffffff0f;
      }

      .mobile-toggle {
        display: none;
      }

      @media (max-width: 800px) {
        .mobile-toggle {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 40px;
          height: 40px;
          border-radius: 10px;
          border: 1px solid #ffffff26;
          background: transparent;
        }

        .links {
          position: fixed;
          inset: 64px 0 auto 0;
          background: linear-gradient(180deg, #0b0f29, #0b0f2945);
          padding: 1rem;
          display: none;
          flex-direction: column;
        }

        .links.open {
          display: flex;
        }
      }

      .wrap {
        max-width: var(--container);
        margin: 28px auto;
        padding: 0 16px;
      }

      h1 {
        color: var(--ink);
        margin: 0 0 8px;
        font-weight: 800;
      }

      h2,
      h3 {
        color: var(--ink);
        margin: 0 0 8px;
      }

      p,
      .muted {
        color: var(--muted);
      }

      .card {
        background: var(--card);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 16px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
        padding: 18px;
        margin: 16px 0;
      }

      .row {
        display: grid;
        gap: 12px;
      }

      @media (min-width: 780px) {
        .cols-2 {
          grid-template-columns: 1fr 1fr;
        }

        .cols-3 {
          grid-template-columns: 1fr 1fr 1fr;
        }
      }

      label {
        color: var(--ink);
        font-size: 14px;
        font-weight: 700;
        margin: 8px 0 4px;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .hint {
        font-size: 12px;
        color: var(--muted);
      }

      input,
      select {
        width: 100%;
        padding: 12px 14px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        background: #0e1330;
        color: var(--ink);
        outline: none;
      }

      input:focus,
      select:focus {
        border-color: var(--acc);
      }

      .btn {
        cursor: pointer;
        background: var(--acc);
        color: #080b1d;
        border: none;
        border-radius: 12px;
        padding: 10px 14px;
        font-weight: 800;
      }

      .btn.secondary {
        background: #25305e;
        color: #cfe0ff;
      }

      .btn.ghost {
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #cfe0ff;
      }

      .actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      code,
      pre {
        background: #0b1030;
        color: #cfe0ff;
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 10px;
      }

      .mono {
        font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, Monaco,
          "Liberation Mono", "Courier New", monospace;
      }

      pre {
        padding: 12px;
        white-space: pre-wrap;
      }

      .status {
        margin-top: 8px;
      }

      .ok {
        color: var(--ok);
      }

      .err {
        color: var(--err);
      }

      .pill {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 999px;
        background: #0b1030;
        border: 1px solid rgba(255, 255, 255, 0.08);
        color: #c7cffd;
        font-size: 12px;
      }

      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
        gap: 12px;
      }

      .gifCard {
        background: #0e1330;
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 12px;
        padding: 10px;
      }

      .gifCard img {
        width: 100%;
        height: 180px;
        object-fit: cover;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.08);
      }

      .tabs {
        display: flex;
        gap: 6px;
        margin: 8px 0;
      }

      .tab {
        padding: 6px 10px;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.15);
        cursor: pointer;
      }

      .tab.active {
        background: var(--acc);
        color: #080b1d;
        border-color: transparent;
      }

      details > summary {
        cursor: pointer;
        color: #cfe0ff;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        overflow: hidden;
      }

      th,
      td {
        padding: 8px 10px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.06);
        color: #cfe0ff;
        font-size: 14px;
      }

      th {
        background: #0e1330;
        text-align: left;
      }

      .kbd {
        font-family: ui-monospace;
        background: #11163a;
        border: 1px solid rgba(255, 255, 255, 0.08);
        padding: 1px 6px;
        border-radius: 6px;
      }

      footer {
        border-top: 1px solid #ffffff14;
        padding-block: 24px;
        margin-top: auto;
      }

      .foot {
        display: flex;
        gap: 1rem;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
      }

      .social {
        display: flex;
        align-items: center;
        gap: 0.6rem;
      }

      .social a {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border-radius: 12px;
        border: 1px solid #ffffff26;
        color: var(--ink);
      }
    </style>
  </head>

  <body>
    <header>
      <div class="container nav" role="navigation" aria-label="Primary">
        <div class="brand">
          <a href="/"
            ><img class="logo" src="/static/icon.png" alt="TAOMA logo"
          /></a>
          <a href="/" style="color: inherit; text-decoration: none">TAOMA™</a>
        </div>
        <button
          type="button"
          class="mobile-toggle"
          id="mobileToggle"
          aria-controls="primary-menu"
          aria-expanded="false"
          aria-label="Toggle menu"
        >
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            aria-hidden="true"
          >
            <path
              d="M4 6H20M4 12H20M4 18H20"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
            />
          </svg>
        </button>
        <nav id="primary-menu" class="links" aria-label="Site">
          <a href="/">Home</a>
          <a href="/projects">Projects</a>
          <a href="/about">About</a>
          <a href="/contact">Contact</a>
          <a href="/skills">Skills</a>
          <a href="/api" aria-current="page">GIF API</a>
        </nav>
        <div id="authSlot" class="auth"></div>
      </div>
    </header>

    <div class="wrap">
      <h1 data-i18n="title.main">Anime GIF API - Explorer &amp; Docs</h1>

      <p data-i18n="intro.main">
        Create requests to <code>/gifs</code>, see the URL, the code (Python
        &amp; cURL) and the answer. Learn the rules &amp; examples below. If
        everything is empty, we call <code>/gifs?</code> for a random GIF.
      </p>

      <div class="card">
        <h2>Ownership &amp; Blacklist</h2>
        <p class="muted">
          Everyone can get and create GIFs. You can edit and delete your own
          GIFs. Admins can manage all GIFs and add users to the blacklist.
        </p>
      </div>

      <!-- BUILDER -->
      <div class="card">
        <h2 data-i18n="section.builder">Query Builder</h2>

        <div class="row cols-3">
          <div>
            <label for="base" data-i18n="label.base">API Base URL</label>
            <input
              id="base"
              type="url"
              value="https://taoma.space"
              data-i18n-placeholder="ph.base"
              placeholder="https://your-api.tld"
              required
            />
            <div class="hint" data-i18n="hint.base">
              Your deployed instance. No / needed at the end.
            </div>
          </div>
          <div>
            <label for="nsfw" data-i18n="label.nsfw">NSFW-mode</label
            >&nbsp;<span class="pill">false|true|only</span>
            <select id="nsfw">
              <option value="false" selected>false</option>
              <option value="true">true</option>
              <option value="only">only</option>
            </select>
            <div class="hint" data-i18n="hint.nsfw">
              Default is <code>false</code>.
            </div>
          </div>
          <div>
            <label for="list" data-i18n="label.list">List (list)</label>
            <select id="list">
              <option value="">-</option>
              <option value="tags">tags</option>
            </select>
            <div class="hint" data-i18n="hint.list">
              With <code>list=tags</code> you get a list of all avaiable tags.
            </div>
          </div>
        </div>

        <div class="row cols-3">
          <div>
            <label for="q" data-i18n="label.q">Search in the title (q)</label>
            <input
              id="q"
              type="text"
              data-i18n-placeholder="ph.q"
              placeholder="e.g. Nazuna"
            />
            <div class="hint" data-i18n="hint.q">
              If this is set, don't use tag/anime/character.
            </div>
          </div>
          <div>
            <label for="tag" data-i18n="label.tag">Tag (tag)</label>
            <div class="actions">
              <select id="tag">
                <option value="">-</option>
              </select>
              <button
                id="refreshTags"
                class="btn secondary"
                type="button"
                data-i18n="btn.refreshTags"
              >
                Reload tags
              </button>
            </div>
            <div class="hint" data-i18n="hint.tags">
              Dropdown loads with <code>GET /gifs?list=tags</code>.
            </div>
          </div>
          <div>
            <label for="anime" data-i18n="label.anime">Anime (anime)</label>
            <input
              id="anime"
              type="text"
              data-i18n-placeholder="ph.anime"
              placeholder="Call of the Night"
            />
            <div class="hint" data-i18n="hint.anime">
              Exact Match (case-insensitive).
            </div>
          </div>
        </div>

        <div class="row cols-3">
          <div>
            <label for="character" data-i18n="label.character"
              >Character (character)</label
            >
            <input
              id="character"
              type="text"
              data-i18n-placeholder="ph.character"
              placeholder="Nazuna"
            />
            <div class="hint" data-i18n="hint.character">
              Exact Match (case-insensitive).
            </div>
          </div>
          <div>
            <label for="limit" data-i18n="label.limit">Limit (limit)</label>
            <input
              id="limit"
              type="number"
              min="1"
              max="200"
              data-i18n-placeholder="ph.limit"
              placeholder="e.g. 50"
            />
            <div class="hint" data-i18n="hint.limit">
              The max amount of results.
            </div>
          </div>
          <div>
            <label for="offset" data-i18n="label.offset">Offset (offset)</label>
            <input
              id="offset"
              type="number"
              min="0"
              data-i18n-placeholder="ph.offset"
              placeholder="e.g. 0"
            />
            <div class="hint" data-i18n="hint.offset">
              Start position (pagination).
            </div>
          </div>
        </div>

        <div class="actions" style="margin-top: 8px">
          <button id="presetRandom" class="btn" data-i18n="btn.presetRandom">
            Preset: Random
          </button>
          <button
            id="presetSfw"
            class="btn secondary"
            data-i18n="btn.presetSfw"
          >
            Preset: Random SFW
          </button>
          <button
            id="presetTag"
            class="btn secondary"
            data-i18n="btn.presetTag"
          >
            Preset: Tag
          </button>
          <button
            id="presetAnime"
            class="btn secondary"
            data-i18n="btn.presetAnime"
          >
            Preset: Anime
          </button>
          <button
            id="presetChar"
            class="btn secondary"
            data-i18n="btn.presetChar"
          >
            Preset: Character
          </button>
          <button id="clearAll" class="btn ghost" data-i18n="btn.reset">
            Reset
          </button>
        </div>

        <div style="margin-top: 14px">
          <label data-i18n="label.finalUrl">Full URL</label>
          <div class="actions">
            <code id="outUrl" class="mono">/gifs?</code>
            <button id="copyUrl" class="btn secondary" data-i18n="btn.copy">
              Copy
            </button>
            <button id="shareUrl" class="btn secondary" data-i18n="btn.share">
              Share-Link
            </button>
            <button id="run" class="btn" data-i18n="btn.run">Run</button>
          </div>
          <div id="ruleMsg" class="status"></div>
        </div>

        <div style="margin-top: 12px">
          <div class="tabs">
            <div id="tabPy" class="tab active" data-i18n="tab.py">
              Python (requests)
            </div>
            <div id="tabCurl" class="tab" data-i18n="tab.curl">cURL</div>
          </div>
          <pre id="codeBox" class="mono"></pre>
          <div class="actions">
            <button
              id="copyCode"
              class="btn secondary"
              data-i18n="btn.copyCode"
            >
              Copy code
            </button>
          </div>
        </div>
      </div>

      <!-- RESULT -->
      <div class="card">
        <h2 data-i18n="section.response">Answer</h2>
        <div id="resultSummary" class="muted">-</div>

        <div id="singleView" style="display: none" class="row cols-2">
          <div>
            <img
              id="gifImg"
              alt="GIF Preview"
              style="
                max-width: 100%;
                border-radius: 12px;
                border: 1px solid rgba(255, 255, 255, 0.08);
              "
            />
          </div>
          <div>
            <div id="gifMeta" class="muted"></div>
            <div class="actions" style="margin-top: 8px">
              <a
                id="openGif"
                class="btn secondary"
                href="#"
                target="_blank"
                rel="noopener"
                data-i18n="btn.openGif"
                >open GIF</a
              >
              <button
                id="copyGifUrl"
                class="btn secondary"
                type="button"
                data-i18n="btn.copyGifUrl"
              >
                copy GIF-URL
              </button>
            </div>
          </div>
        </div>

        <div id="listView" class="grid" style="display: none"></div>

        <div class="actions" style="margin-top: 10px">
          <button id="prevPage" class="btn secondary" data-i18n="btn.prev">
            < Back
          </button>
          <button id="nextPage" class="btn secondary" data-i18n="btn.next">
            Next >
          </button>
        </div>

        <pre id="rawBox" class="mono muted" style="margin-top: 12px">-</pre>
      </div>

      <!-- HISTORY -->
      <div class="card">
        <h2 data-i18n="section.history">History (local)</h2>
        <p class="muted" data-i18n="history.info">
          Last few requests. Click to load them again.
        </p>
        <div id="history" class="grid"></div>
        <div class="actions" style="margin-top: 8px">
          <button
            id="clearHistory"
            class="btn ghost"
            data-i18n="btn.clearHistory"
          >
            delete history
          </button>
        </div>
      </div>

      <!-- DOCS -->
      <div class="card">
        <h2 data-i18n="section.docs">API-Documentation</h2>

        <details open>
          <summary data-i18n="docs.rules.title">
            <b>Rules &amp; Behaviour</b>
          </summary>
          <ul>
            <li data-i18n="docs.rule1">
              <span class="kbd">q</span> (title search) is exclusive:
              <b>Either</b> <span class="kbd">q</span> <b>or</b> exactly one of
              <span class="kbd">tag</span>/<span class="kbd">anime</span>/<span
                class="kbd"
                >character</span
              >.
            </li>
            <li data-i18n="docs.rule2">
              <span class="kbd">nsfw</span> ? {<code>false</code>,
              <code>true</code>, <code>only</code>} - Default:
              <code>false</code>.
            </li>
            <li data-i18n="docs.rule3">
              A request without any filter (<code>/gifs?</code>) returns a
              random GIF with the NSFW filter depending on <code>nsfw</code>.
            </li>
            <li data-i18n="docs.rule4">
              <span class="kbd">limit</span> &amp;
              <span class="kbd">offset</span> are used for pagination (only
              useful for title search).
            </li>
            <li data-i18n="docs.rule5">
              <code>list=tags</code> returns all tags (ignores other filters).
            </li>
          </ul>
        </details>

        <div style="overflow: auto; margin-top: 10px">
          <table>
            <thead>
              <tr>
                <th data-i18n="tbl.param">Parameter</th>
                <th data-i18n="tbl.type">Type</th>
                <th data-i18n="tbl.example">Example</th>
                <th data-i18n="tbl.desc">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>q</code></td>
                <td>string</td>
                <td><code>q=Nazuna</code></td>
                <td data-i18n="docs.row.q">
                  Searches the <b>title</b>; do not combine with
                  tag/anime/character.
                </td>
              </tr>
              <tr>
                <td><code>tag</code></td>
                <td>string</td>
                <td><code>tag=smoking</code></td>
                <td data-i18n="docs.row.tag">
                  Random GIF with the selected tag.
                </td>
              </tr>
              <tr>
                <td><code>anime</code></td>
                <td>string</td>
                <td><code>anime=Call of the Night</code></td>
                <td data-i18n="docs.row.anime">Random GIF of this anime.</td>
              </tr>
              <tr>
                <td><code>character</code></td>
                <td>string</td>
                <td><code>character=Nazuna</code></td>
                <td data-i18n="docs.row.character">
                  Random GIF with the selected character.
                </td>
              </tr>
              <tr>
                <td><code>list</code></td>
                <td>string</td>
                <td><code>list=tags</code></td>
                <td data-i18n="docs.row.list">List of all tags.</td>
              </tr>
              <tr>
                <td><code>nsfw</code></td>
                <td>enum</td>
                <td><code>nsfw=false</code></td>
                <td data-i18n="docs.row.nsfw">
                  <code>false</code>=only SFW, <code>true</code>=both,
                  <code>only</code>=only NSFW.
                </td>
              </tr>
              <tr>
                <td><code>limit</code></td>
                <td>int</td>
                <td><code>limit=20</code></td>
                <td data-i18n="docs.row.limit">
                  Max results (1-200) for title search.
                </td>
              </tr>
              <tr>
                <td><code>offset</code></td>
                <td>int</td>
                <td><code>offset=20</code></td>
                <td data-i18n="docs.row.offset">
                  Start position (pagination) for title search.
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <p class="muted" style="margin-top: 8px" data-i18n="docs.note">
          Hint: For typos in <code>anime</code>/<code>character</code>
          the API returns meaningful suggestions in the error object (HTTP 404,
          field
          <code>suggestions</code>).
        </p>
      </div>
    </div>

    <footer>
      <div class="container foot">
        <div class="muted">TAOMA™ - Anime GIF API</div>
        <div class="social">
          <a
            class="iso-pro is-gh"
            href="https://github.com/TAOMA™"
            aria-label="GitHub"
          >
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="currentColor"
              aria-hidden="true"
            >
              <path
                d="M12 .5C5.73.5.5 5.74.5 12.02c0 5.1 3.29 9.42 7.86 10.95.58.12.79-.25.79-.56 0-.28-.01-1.02-.02-2-3.2.7-3.88-1.54-3.88-1.54-.53-1.35-1.3-1.71-1.3-1.71-1.06-.73.08-.72.08-.72 1.17.08 1.78 1.21 1.78 1.21 1.04 1.78 2.74 1.26 3.41.96.1-.76.41-1.26.75-1.55-2.56-.29-5.26-1.28-5.26-5.69 0-1.26.45-2.29 1.19-3.1-.12-.29-.52-1.45.11-3.02 0 0 .97-.31 3.18 1.18a11.1 11.1 0 0 1 5.79 0c2.2-1.49 3.17-1.18 3.17-1.18.64 1.57.24 2.73.12 3.02.74.81 1.19 1.84 1.19 3.1 0 4.42-2.7 5.39-5.28 5.67.42.36.8 1.08.8 2.19 0 1.58-.02 2.85-.02 3.24 0 .31.21.69.8.57A10.53 10.53 0 0 0 23.5 12C23.5 5.74 18.27.5 12 .5Z"
              />
            </svg>
          </a>
          <a
            class="iso-pro is-mail"
            href="mailto:kontakt@taoma.space"
            aria-label="E-Mail"
          >
            <svg
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              aria-hidden="true"
            >
              <path
                d="M4 6h16a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2Z"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M4 6 12 13 20 6"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </a>
          <a
            class="iso-pro is-discord"
            href="https://discord.gg/"
            aria-label="Discord"
          >
            <svg
              width="18"
              height="18"
              viewBox="0 0 245 240"
              fill="currentColor"
              aria-hidden="true"
            >
              <path
                d="M104.4 104.9c-5.7 0-10.2 5-10.2 11.1 0 6.1 4.6 11.1 10.2 11.1 5.7 0 10.2-5 10.2-11.1.1-6.1-4.5-11.1-10.2-11.1zm36.2 0c-5.7 0-10.2 5-10.2 11.1 0 6.1 4.6 11.1 10.2 11.1 5.7 0 10.2-5 10.2-11.1 0-6.1-4.5-11.1-10.2-11.1z"
              />
              <path
                d="M189.5 20h-134C44.2 20 35 29.2 35 40.7v135.2c0 11.5 9.2 20.7 20.5 20.7h113.4l-5.3-18.4 12.8 11.8 12.1 11.2 21.5 19V40.7c0-11.5-9.2-20.7-20.5-20.7zm-38.6 135s-3.6-4.3-6.6-8.1c13.1-3.7 18.1-11.8 18.1-11.8-4.1 2.7-8 4.6-11.5 5.9-5 2.1-9.8 3.4-14.5 4.3-9.6 1.8-18.4 1.3-25.9-.1-5.7-1.1-10.6-2.6-14.7-4.3-2.3-.9-4.8-2-7.4-3.4-.3-.2-.6-.3-.9-.5-.2-.1-.3-.2-.4-.3-1.8-1-2.8-1.7-2.8-1.7s4.8 7.9 17.5 11.7c-3 3.8-6.7 8.3-6.7 8.3-22.1-.7-30.5-15.2-30.5-15.2 0-32.1 14.4-58.1 14.4-58.1 14.4-10.8 28-10.5 28-10.5l1 1.2c-18 5.2-26.3 13.1-26.3 13.1s2.2-1.2 5.9-2.9c10.7-4.7 19.2-5.9 22.7-6.2.6-.1 1.1-.2 1.7-.2 6.1-.8 13-1 20.2-.2 9.5 1.1 19.7 3.9 30.1 9.6 0 0-7.9-7.5-24.9-12.7l1.4-1.6s13.7-.3 28 10.5c0 0 14.4 26 14.4 58.1 0-.1-8.5 14.4-30.6 15.1z"
              />
            </svg>
          </a>
        </div>
      </div>
    </footer>

    <script>
      (function () {
        const menu = document.getElementById("primary-menu");
        const toggle = document.getElementById("mobileToggle");
        if (menu && toggle) {
          toggle.addEventListener("click", () => {
            const open = menu.classList.toggle("open");
            toggle.setAttribute("aria-expanded", open ? "true" : "false");
          });
        }
      })();

      const $ = (s) => document.querySelector(s);
      const el = (id) => document.getElementById(id);

      // Inputs
      const base = el("base"),
        nsfw = el("nsfw"),
        listSel = el("list");
      const q = el("q"),
        tag = el("tag"),
        anime = el("anime"),
        character = el("character");
      const limit = el("limit"),
        offset = el("offset");

      // UI outputs
      const outUrl = el("outUrl"),
        ruleMsg = el("ruleMsg");
      const codeBox = el("codeBox");
      let activeTab = "py";
      const resultSummary = el("resultSummary"),
        rawBox = el("rawBox");
      const singleView = el("singleView"),
        gifImg = el("gifImg"),
        gifMeta = el("gifMeta"),
        openGif = el("openGif");
      const listView = el("listView");
      const prevPage = el("prevPage"),
        nextPage = el("nextPage");
      const historyWrap = el("history");

      // State
      const PAGE_DEFAULT = 20;

      // Helpers
      function cleanBase(u) {
        return (u || "").replace(/\/+$/, "");
      }
      function paramsValidXor(p) {
        const hasQ = !!p.q;
        const singles = ["tag", "anime", "character"].filter((k) => !!p[k]);
        if (hasQ && singles.length > 0)
          return {
            ok: false,
            msg: "Set either 'q' OR one of 'tag/anime/character' - NOT both.",
          };
        if (!hasQ && singles.length > 1)
          return {
            ok: false,
            msg: "Please only set ONE of 'tag/anime/character'.",
          };
        return { ok: true, msg: "" };
      }
      function buildParams() {
        const p = {};
        if (q.value.trim()) p.q = q.value.trim();
        if (!p.q) {
          if (tag.value) p.tag = tag.value;
          else if (anime.value.trim()) p.anime = anime.value.trim();
          else if (character.value.trim()) p.character = character.value.trim();
        }
        if (listSel.value) p.list = listSel.value;
        p.nsfw = nsfw.value || "false";
        if (limit.value) p.limit = Number(limit.value);
        if (offset.value) p.offset = Number(offset.value);
        return p;
      }
      function paramsToQS(p) {
        const sp = new URLSearchParams();
        Object.entries(p).forEach(([k, v]) => {
          if (v !== undefined && v !== null && v !== "") sp.set(k, String(v));
        });
        const s = sp.toString();
        return s ? "/api/gifs?" + s : "/api/gifs?";
      }
      function renderUrlAndCode() {
        const p = buildParams();
        const v = paramsValidXor(p);
        ruleMsg.textContent = v.ok ? "" : v.msg;
        ruleMsg.className = "status " + (v.ok ? "" : "err");

        const path = paramsToQS(p);
        const full = cleanBase(base.value) + path;
        outUrl.textContent = full;

        const py = `import requests

BASE = "${cleanBase(base.value)}"
params = ${JSON.stringify(p, null, 2) || "{}"}
r = requests.get(f"{BASE}/api/gifs", params=(params or None), timeout=10)
r.raise_for_status()
print(r.json())`;

        const curl = `curl -sS "${cleanBase(base.value)}/api/gifs${
          Object.keys(p).length ? "?" + new URLSearchParams(p).toString() : ""
        }"`;

        codeBox.textContent = activeTab === "py" ? py : curl;
      }
      function syncLocks() {
        const hasQ = q.value.trim() !== "";
        [tag, anime, character].forEach((elm) => (elm.disabled = hasQ));
        const singles = [
          tag.value,
          anime.value.trim(),
          character.value.trim(),
        ].filter(Boolean).length;
        q.disabled = singles > 0;
      }

      // Events
      [base, nsfw, listSel, q, tag, anime, character, limit, offset].forEach(
        (x) => {
          x.addEventListener("input", () => {
            syncLocks();
            renderUrlAndCode();
          });
          x.addEventListener("change", () => {
            syncLocks();
            renderUrlAndCode();
          });
        }
      );

      el("tabPy").onclick = () => {
        activeTab = "py";
        el("tabPy").classList.add("active");
        el("tabCurl").classList.remove("active");
        renderUrlAndCode();
      };
      el("tabCurl").onclick = () => {
        activeTab = "curl";
        el("tabCurl").classList.add("active");
        el("tabPy").classList.remove("active");
        renderUrlAndCode();
      };

      el("copyUrl").onclick = async () => {
        try {
          await navigator.clipboard.writeText(outUrl.textContent);
        } catch {}
      };
      el("shareUrl").onclick = async () => {
        try {
          await navigator.clipboard.writeText(outUrl.textContent);
        } catch {}
      };
      el("copyCode").onclick = async () => {
        try {
          await navigator.clipboard.writeText(codeBox.textContent);
        } catch {}
      };
      el("copyGifUrl")?.addEventListener("click", async () => {
        try {
          await navigator.clipboard.writeText(openGif.href);
        } catch {}
      });

      function resetFilters() {
        q.value = "";
        tag.value = "";
        anime.value = "";
        character.value = "";
        limit.value = "";
        offset.value = "";
        listSel.value = "";
        nsfw.value = "false";
      }
      el("presetRandom").onclick = (e) => {
        e.preventDefault();
        resetFilters();
        nsfw.value = "true";
        renderUrlAndCode();
      };
      el("presetSfw").onclick = (e) => {
        e.preventDefault();
        resetFilters();
        nsfw.value = "false";
        renderUrlAndCode();
      };
      el("presetTag").onclick = (e) => {
        e.preventDefault();
        resetFilters();
        tag.value = tag.options.length > 1 ? tag.options[1].value : "";
        nsfw.value = "true";
        renderUrlAndCode();
      };
      el("presetAnime").onclick = (e) => {
        e.preventDefault();
        resetFilters();
        anime.value = "Call of the Night";
        nsfw.value = "false";
        renderUrlAndCode();
      };
      el("presetChar").onclick = (e) => {
        e.preventDefault();
        resetFilters();
        character.value = "Nazuna";
        nsfw.value = "false";
        renderUrlAndCode();
      };
      el("clearAll").onclick = (e) => {
        e.preventDefault();
        resetFilters();
        renderUrlAndCode();
      };

      async function loadTags() {
        try {
          const url = cleanBase(base.value) + "/api/gifs?list=tags";
          const r = await fetch(url);
          if (!r.ok) throw new Error(await r.text());
          const tagsList = await r.json();
          const cur = tag.value;
          tag.innerHTML =
            '<option value="">-</option>' +
            (tagsList || []).map((t) => `<option>${t}</option>`).join("");
          if ([...tag.options].some((o) => o.value === cur)) tag.value = cur;
        } catch (e) {
          console.warn("Tags could not be loaded.", e);
        }
      }
      el("refreshTags").onclick = loadTags;
      window.addEventListener("load", loadTags);

      function pushHistory(fullUrl) {
        try {
          const h = JSON.parse(localStorage.getItem("gifapi_history") || "[]");
          h.unshift({ url: fullUrl, ts: Date.now() });
          const uniq = [];
          const seen = new Set();
          for (const item of h) {
            if (!seen.has(item.url)) {
              uniq.push(item);
              seen.add(item.url);
            }
            if (uniq.length >= 30) break;
          }
          localStorage.setItem("gifapi_history", JSON.stringify(uniq));
        } catch {}
      }
      function renderHistory() {
        try {
          const h = JSON.parse(localStorage.getItem("gifapi_history") || "[]");
          historyWrap.innerHTML = h
            .map(
              (it) => `
          <div class="gifCard">
            <div class="muted" style="font-size:12px">${new Date(
              it.ts
            ).toLocaleString()}</div>
            <div style="word-break:break-all;color:#e7e9ff;font-size:13px;margin:6px 0">${
              it.url
            }</div>
            <div class="actions">
              <button class="btn secondary" data-open="${it.url}">Open</button>
              <button class="btn ghost" data-apply="${
                it.url
              }">Load into Builder</button>
            </div>
          </div>`
            )
            .join("");
          historyWrap
            .querySelectorAll("[data-open]")
            .forEach(
              (b) => (b.onclick = () => window.open(b.dataset.open, "_blank"))
            );
          historyWrap.querySelectorAll("[data-apply]").forEach(
            (b) =>
              (b.onclick = () => {
                const u = new URL(b.dataset.apply);
                base.value = u.origin;
                const sp = u.searchParams;
                q.value = sp.get("q") || "";
                tag.value = sp.get("tag") || "";
                anime.value = sp.get("anime") || "";
                character.value = sp.get("character") || "";
                nsfw.value = sp.get("nsfw") || "false";
                listSel.value = sp.get("list") || "";
                limit.value = sp.get("limit") || "";
                offset.value = sp.get("offset") || "";
                syncLocks();
                renderUrlAndCode();
              })
          );
        } catch {
          historyWrap.innerHTML = "";
        }
      }
      el("clearHistory").onclick = () => {
        localStorage.removeItem("gifapi_history");
        renderHistory();
      };

      async function runQuery() {
        const p = buildParams();
        const v = paramsValidXor(p);
        if (!v.ok) {
          ruleMsg.textContent = v.msg;
          ruleMsg.className = "status err";
          return;
        }

        const baseUrl = cleanBase(base.value);
        const qs = new URLSearchParams(p);
        const url =
          baseUrl + "/api/gifs" + (qs.toString() ? "?" + qs.toString() : "");
        outUrl.textContent = url;

        try {
          const r = await fetch(url);
          const text = await r.text();
          let data = null;
          try {
            data = JSON.parse(text);
          } catch {
            data = { raw: text };
          }
          rawBox.textContent = JSON.stringify(data, null, 2);

          singleView.style.display = "none";
          listView.style.display = "none";
          if (Array.isArray(data)) {
            resultSummary.textContent = `${data.length} result(s).`;
            listView.innerHTML = data
              .map(
                (g) => `
            <div class="gifCard">
              <img src="${g.url || ""}" alt="">
              <div style="color:#e7e9ff;font-weight:700;margin-top:6px">${
                g.title || "-"
              }</div>
              <div class="muted" style="font-size:12px">#${g.id || "?"} - ${
                  g.anime || "-"
                } - ${g.nsfw ? "nsfw" : "sfw"}</div>
              <div class="actions" style="margin-top:6px">
                <a class="btn secondary" href="${
                  g.url || "#"
                }" target="_blank" rel="noopener">Open</a>
                <button class="btn ghost" data-copy="${
                  g.url || ""
                }">Copy URL</button>
              </div>
            </div>`
              )
              .join("");
            listView.querySelectorAll("[data-copy]").forEach(
              (b) =>
                (b.onclick = async () => {
                  try {
                    await navigator.clipboard.writeText(b.dataset.copy);
                  } catch {}
                })
            );
            listView.style.display = "";
          } else if (data && data.url) {
            resultSummary.textContent = `1 result.`;
            gifImg.src = data.url;
            openGif.href = data.url;
            gifMeta.innerHTML = `
            <div><b>Title:</b> ${data.title || "-"}</div>
            <div><b>ID:</b> ${data.id || "-"}</div>
            <div><b>Anime:</b> ${data.anime || "-"} &nbsp; <span class="pill">${
              data.nsfw ? "nsfw" : "sfw"
            }</span></div>
            <div><b>Tags:</b> ${(data.tags || []).join(", ") || "-"}</div>
            <div><b>Characters:</b> ${
              (data.characters || []).join(", ") || "-"
            }</div>
            <div class="muted">created_at: ${data.created_at || "-"}</div>`;
            singleView.style.display = "";
          } else if (p.list === "tags" && Array.isArray(data)) {
            resultSummary.textContent = `${data.length} Tags.`;
          } else {
            resultSummary.textContent = "Response received.";
          }

          pushHistory(url);
          renderHistory();
        } catch (err) {
          resultSummary.textContent = "Error: " + err.message;
        }
      }
      el("run").onclick = (e) => {
        e.preventDefault();
        runQuery();
      };

      prevPage.onclick = (e) => {
        e.preventDefault();
        const l = Number(limit.value || PAGE_DEFAULT);
        const o = Math.max(0, Number(offset.value || 0) - l);
        offset.value = String(o);
        renderUrlAndCode();
        runQuery();
      };
      nextPage.onclick = (e) => {
        e.preventDefault();
        const l = Number(limit.value || PAGE_DEFAULT);
        const o = Number(offset.value || 0) + l;
        offset.value = String(o);
        renderUrlAndCode();
        runQuery();
      };

      window.addEventListener("load", () => {
        syncLocks();
        if (!limit.value) limit.value = String(PAGE_DEFAULT);
        renderUrlAndCode();
        renderHistory();
      });
    </script>
  </body>
</html>
