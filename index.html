<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <title>TAOMA Space ‚Äî GIF API &amp; Linktree</title>
    <meta
      content="Explore the Anime GIF API, add your own GIFs, and build a Linktree that actually converts."
      name="description"
    />
    <meta content="TAOMA Space ‚Äî GIF API &amp; Linktree" property="og:title" />
    <meta
      content="Query the Anime GIF API, contribute new GIFs, and spin up a custom Linktree in minutes."
      property="og:description"
    />
    <meta content="website" property="og:type" />
    <meta content="https://taoma.space/" property="og:url" />
    <meta content="https://taoma.space/static/icon.png" property="og:image" />
    <meta content="summary_large_image" name="twitter:card" />
    <meta content="TAOMA Space ‚Äî GIF API &amp; Linktree" name="twitter:title" />
    <meta
      content="Query the Anime GIF API, contribute new GIFs, and spin up a custom Linktree in minutes."
      name="twitter:description"
    />
    <meta content="https://taoma.space/static/icon.png" name="twitter:image" />
    <link href="https://taoma.space/" rel="canonical" />
    <meta content="index,follow" name="robots" />
    <meta content="#0f1223" name="theme-color" />
    <link href="/static/icon.png" rel="icon" type="image/png" />
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "TAOMA Space",
        "url": "https://taoma.space/",
        "description": "Anime GIF API, GIF contributions und ein performanter Linktree Builder.",
        "inLanguage": "de",
        "publisher": {
          "@type": "Organization",
          "name": "TAOMA",
          "url": "https://taoma.space/",
          "logo": {
            "@type": "ImageObject",
            "url": "https://taoma.space/static/icon.png"
          },
          "email": "mailto:kontakt@taoma.space"
        }
      }
    </script>
    <style>
      /* =========================================================
   TAOMA ‚Äî Home (UI refresh)
   Goal: friendlier, clearer, more beginner-friendly
   NOTE: No IDs/classes used by JS were changed.
========================================================= */

      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }

      :root {
        --font: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto,
          Inter, Arial, sans-serif;
        --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;

        /* Dark default */
        --bg: #0b1220;
        --bg-grad-1: rgba(122, 162, 255, 0.18);
        --bg-grad-2: rgba(93, 214, 194, 0.12);

        --surface: #0f1a2e;
        --surface-2: #12223d;
        --card: rgba(255, 255, 255, 0.06);
        --card-solid: #0f1a2e;

        --ink: #eaf0ff;
        --muted: rgba(234, 240, 255, 0.72);
        --muted-2: rgba(234, 240, 255, 0.56);

        --border: rgba(255, 255, 255, 0.12);
        --border-2: rgba(255, 255, 255, 0.18);

        --acc: #5dd6c2; /* teal */
        --acc-2: #7aa2ff; /* blue */
        --danger: #ff5a6a;
        --ok: #2fe0a8;

        --ring: rgba(93, 214, 194, 0.45);
        --shadow: 0 18px 55px rgba(0, 0, 0, 0.35);
        --shadow-soft: 0 10px 28px rgba(0, 0, 0, 0.22);

        --r-12: 12px;
        --r-16: 16px;
        --r-20: 20px;

        --space: clamp(14px, 2.2vw, 22px);
        --container: 1100px;
      }

      @media (prefers-color-scheme: light) {
        :root {
          --bg: #f6f8ff;
          --bg-grad-1: rgba(122, 162, 255, 0.18);
          --bg-grad-2: rgba(93, 214, 194, 0.18);

          --surface: #ffffff;
          --surface-2: #eef3ff;
          --card: rgba(15, 23, 42, 0.04);
          --card-solid: #ffffff;

          --ink: #0f172a;
          --muted: rgba(15, 23, 42, 0.72);
          --muted-2: rgba(15, 23, 42, 0.56);

          --border: rgba(15, 23, 42, 0.1);
          --border-2: rgba(15, 23, 42, 0.14);

          --shadow: 0 18px 55px rgba(2, 8, 23, 0.1);
          --shadow-soft: 0 10px 28px rgba(2, 8, 23, 0.08);
        }
      }

      html,
      body {
        height: 100%;
      }

      body {
        margin: 0;
        font: 15px/1.6 var(--font);
        color: var(--ink);
        min-height: 100dvh;
        display: flex;
        flex-direction: column;
        overflow-x: hidden;
        max-width: 100vw;
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background: radial-gradient(
            1100px 820px at 8% -10%,
            var(--bg-grad-1),
            transparent 60%
          ),
          radial-gradient(
            900px 700px at 92% 10%,
            var(--bg-grad-2),
            transparent 58%
          ),
          linear-gradient(
            160deg,
            color-mix(in oklab, var(--bg) 90%, #000 10%),
            var(--bg)
          );
      }

      a {
        color: inherit;
        text-decoration: none;
      }

      .container {
        width: min(100%, var(--container));
        margin: 0 auto;
        padding: 0 var(--space);
      }

      /* ---------- Header / Nav ---------- */
      header {
        position: sticky;
        top: 0;
        z-index: 50;
        backdrop-filter: saturate(1.1) blur(10px);
        -webkit-backdrop-filter: saturate(1.1) blur(10px);
        background: linear-gradient(
          180deg,
          color-mix(in oklab, var(--bg) 86%, transparent),
          transparent
        );
        border-bottom: 1px solid var(--border);
      }

      .nav {
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 66px;
        gap: 12px;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-weight: 900;
        letter-spacing: 0.3px;
      }

      .brand a:last-child {
        padding: 0.35rem 0.55rem;
        border-radius: 10px;
      }

      .brand a:last-child:hover {
        background: color-mix(in oklab, var(--ink) 8%, transparent);
      }

      .brand .logo {
        width: 30px;
        height: 30px;
        border-radius: 10px;
        display: block;
        box-shadow: var(--shadow-soft);
      }

      .links {
        display: flex;
        gap: 0.4rem;
        align-items: center;
        flex-wrap: wrap;
      }

      .links a {
        padding: 0.55rem 0.75rem;
        border-radius: 12px;
        border: 1px solid transparent;
        color: var(--muted);
        font-weight: 750;
        transition: background 0.15s ease, border-color 0.15s ease,
          color 0.15s ease;
      }

      .links a:hover {
        background: color-mix(in oklab, var(--ink) 10%, transparent);
        border-color: var(--border);
        color: var(--ink);
      }

      .links a[aria-current="page"] {
        background: color-mix(in oklab, var(--acc) 18%, transparent);
        border-color: color-mix(in oklab, var(--acc) 40%, var(--border));
        color: var(--ink);
      }

      .auth {
        display: flex;
        align-items: center;
        gap: 0.55rem;
      }

      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.55rem;
        padding: 0.85rem 1.1rem;
        border-radius: 14px;
        border: 1px solid color-mix(in oklab, var(--acc) 26%, var(--border));
        background: linear-gradient(120deg, var(--acc), var(--acc-2));
        color: color-mix(in oklab, #071018 90%, var(--ink) 10%);
        font-weight: 900;
        letter-spacing: 0.2px;
        box-shadow: var(--shadow-soft);
        transition: transform 0.14s ease, filter 0.18s ease,
          box-shadow 0.18s ease;
      }

      .btn:hover {
        transform: translateY(-1px);
        filter: saturate(1.06);
        box-shadow: var(--shadow);
      }
      .btn:active {
        transform: translateY(0px);
      }

      .btn.ghost {
        background: color-mix(in oklab, var(--surface) 70%, transparent);
        color: var(--ink);
        border-color: var(--border);
        box-shadow: none;
      }

      .btn.ghost:hover {
        background: color-mix(in oklab, var(--surface) 82%, transparent);
      }

      .btn.small {
        padding: 0.55rem 0.75rem;
        border-radius: 12px;
        font-weight: 850;
      }

      /* Avatar menu (keeps JS hooks) */
      .auth-box {
        position: relative;
      }
      .avatar-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.55rem;
        padding: 0.38rem 0.55rem;
        border-radius: 14px;
        background: color-mix(in oklab, var(--surface) 78%, transparent);
        border: 1px solid var(--border);
        color: var(--ink);
        cursor: pointer;
      }

      .avatar-btn:hover {
        background: color-mix(in oklab, var(--surface) 90%, transparent);
      }

      .avatar {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        object-fit: cover;
        box-shadow: var(--shadow-soft);
      }
      .avatar-fallback {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: grid;
        place-items: center;
        background: color-mix(in oklab, var(--ink) 10%, transparent);
        border: 1px solid var(--border);
        font-weight: 900;
      }

      .menu {
        position: absolute;
        top: calc(100% + 10px);
        right: 0;
        min-width: 190px;
        display: none;
        flex-direction: column;
        border-radius: 14px;
        overflow: hidden;
        background: color-mix(in oklab, var(--surface) 92%, transparent);
        border: 1px solid var(--border);
        box-shadow: var(--shadow);
      }
      .menu.open {
        display: flex;
      }

      .menu a,
      .menu button {
        padding: 0.7rem 0.85rem;
        text-align: left;
        background: transparent;
        border: 0;
        color: var(--ink);
        cursor: pointer;
        font-weight: 750;
      }
      .menu a:hover,
      .menu button:hover {
        background: color-mix(in oklab, var(--ink) 10%, transparent);
      }

      /* Mobile nav */
      .mobile-toggle {
        display: none;
        width: 42px;
        height: 42px;
        border-radius: 12px;
        border: 1px solid var(--border);
        background: color-mix(in oklab, var(--surface) 70%, transparent);
        color: var(--ink);
      }
      .mobile-toggle:hover {
        background: color-mix(in oklab, var(--surface) 85%, transparent);
      }

      @media (max-width: 820px) {
        .mobile-toggle {
          display: inline-flex;
          align-items: center;
          justify-content: center;
        }
        .links {
          position: fixed;
          inset: 66px 0 auto 0;
          padding: 1rem var(--space);
          background: color-mix(in oklab, var(--bg) 80%, transparent);
          border-bottom: 1px solid var(--border);
          display: none;
          flex-direction: column;
          align-items: flex-start;
          gap: 0.35rem;
        }
        .links.open {
          display: flex;
        }
        .links a {
          width: 100%;
        }
      }

      /* ---------- Main / Sections ---------- */
      main {
        flex: 1;
        padding-bottom: 64px;
      }

      .hero {
        padding: clamp(36px, 7vw, 92px) 0 clamp(26px, 5vw, 54px);
        display: grid;
        grid-template-columns: 1.12fr 0.88fr;
        gap: clamp(18px, 4vw, 34px);
        align-items: center;
      }

      .hero h1 {
        margin: 0 0 0.65rem;
        font-size: clamp(32px, 6vw, 56px);
        line-height: 1.06;
        letter-spacing: -0.02em;
      }

      .subtitle {
        margin: 0 0 1.35rem;
        font-size: clamp(16px, 2.6vw, 20px);
        color: var(--muted);
      }

      .eyebrow {
        display: inline-flex;
        align-items: center;
        gap: 0.45rem;
        padding: 0.42rem 0.78rem;
        border-radius: 999px;
        background: color-mix(in oklab, var(--acc) 18%, transparent);
        border: 1px solid color-mix(in oklab, var(--acc) 36%, var(--border));
        color: var(--ink);
        font-weight: 850;
        letter-spacing: 0.35px;
        margin-bottom: 0.8rem;
      }

      .cta-row {
        display: flex;
        flex-wrap: wrap;
        gap: 0.85rem;
        align-items: center;
      }

      .tagline {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
        gap: 0.75rem;
        margin-top: 1.25rem;
      }

      .pill {
        display: inline-flex;
        align-items: center;
        gap: 0.55rem;
        padding: 0.65rem 0.8rem;
        border-radius: 14px;
        border: 1px solid var(--border);
        background: color-mix(in oklab, var(--surface) 68%, transparent);
        color: var(--ink);
        font-weight: 800;
      }

      .section {
        padding: clamp(26px, 5vw, 56px) 0;
      }

      .section h2 {
        margin: 0 0 0.55rem;
        font-size: clamp(22px, 3vw, 30px);
        letter-spacing: -0.01em;
      }

      .helper {
        margin: 0 0 1.2rem;
        color: var(--muted);
      }

      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: clamp(14px, 2vw, 20px);
      }

      .mini-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 0.9rem;
      }

      .card {
        background: linear-gradient(
          180deg,
          color-mix(in oklab, var(--surface) 86%, transparent),
          color-mix(in oklab, var(--surface-2) 76%, transparent)
        );
        border: 1px solid var(--border);
        border-radius: 18px;
        box-shadow: var(--shadow-soft);
        padding: clamp(16px, 2vw, 22px);
      }

      .card h3 {
        margin: 0 0 0.35rem;
        font-size: 1.08rem;
        letter-spacing: 0.2px;
      }
      .card p {
        margin: 0 0 0.95rem;
        color: var(--muted);
      }

      .chip-row {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 0.85rem;
      }
      .chip {
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        padding: 0.48rem 0.72rem;
        border-radius: 999px;
        border: 1px solid var(--border);
        background: color-mix(in oklab, var(--surface) 70%, transparent);
        color: var(--ink);
        font-weight: 750;
        font-size: 0.95rem;
      }

      .code {
        font-family: var(--mono);
        background: color-mix(in oklab, var(--bg) 60%, #000 40%);
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 0.95rem 1rem;
        overflow-x: auto;
        white-space: pre;
        margin: 0;
        box-shadow: inset 0 0 0 1px
          color-mix(in oklab, var(--ink) 6%, transparent);
      }

      .notice {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
        flex-wrap: wrap;
        padding: 1rem 1.15rem;
        border-radius: 16px;
        border: 1px dashed color-mix(in oklab, var(--acc-2) 40%, var(--border));
        background: color-mix(in oklab, var(--surface) 70%, transparent);
        color: var(--muted);
      }

      .notice strong {
        color: var(--ink);
      }

      code {
        font-family: var(--mono);
        font-size: 0.95em;
        padding: 0.1rem 0.35rem;
        border-radius: 8px;
        border: 1px solid var(--border);
        background: color-mix(in oklab, var(--surface) 72%, transparent);
      }

      /* Focus / accessibility */
      :focus {
        outline: none;
      }
      :focus-visible {
        outline: 3px solid var(--ring);
        outline-offset: 2px;
      }

      @media (max-width: 900px) {
        .hero {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div aria-label="Primary" class="container nav" role="navigation">
        <div class="brand">
          <a href="/"
            ><img
              alt="TAOMA logo"
              class="logo"
              height="30"
              src="/static/icon.png"
              width="30"
          /></a>
          <a href="/">TAOMA‚Ñ¢</a>
        </div>
        <button
          aria-controls="primary-menu"
          aria-expanded="false"
          aria-label="Toggle menu"
          class="mobile-toggle"
          id="mobileToggle"
          type="button"
        >
          <svg
            aria-hidden="true"
            fill="none"
            height="20"
            viewbox="0 0 24 24"
            width="20"
          >
            <path
              d="M4 6H20M4 12H20M4 18H20"
              stroke="currentColor"
              stroke-linecap="round"
              stroke-width="2"
            ></path>
          </svg>
        </button>
        <nav aria-label="Site" class="links" id="primary-menu">
          <a aria-current="page" href="/">Home</a>
          <a href="/api">GIF API</a>
          <a href="/api/gif/admin">Add GIFs</a>
          <a href="/marketplace">Marketplace</a>
          <a href="/linktree/config">Linktree</a>
        </nav>
        <div class="auth" id="authSlot"></div>
      </div>
    </header>
    <main>
      <div class="container">
        <section class="hero">
          <div>
            <div class="eyebrow">User-first hub</div>
            <h1>Ship GIFs. Share Links. Welcome in.</h1>
            <p class="subtitle">
              The Anime GIF API lets you query and contribute community-picked
              reactions. The Linktree builder gives you a polished hub for
              everything you do. Start with the explorer, or jump straight into
              editing your tree.
            </p>
            <div class="cta-row">
              <a class="btn" href="/api">Open GIF API explorer</a>
              <a class="btn ghost" href="/linktree/config"
                >Build your Linktree</a
              >
              <a class="btn ghost" href="/api/gif/admin">Add a new GIF</a>
            </div>
            <div class="tagline">
              <span class="pill">‚ö° Fast explorer + code snippets</span>
              <span class="pill">üß© Add &amp; moderate GIFs with tags</span>
              <span class="pill"
                >üåê Linktree with avatars, music &amp; effects</span
              >
            </div>
          </div>
          <div class="card">
            <div class="chip-row">
              <span class="chip">REST ¬∑ GET/POST/PATCH</span>
              <span class="chip">Rate-limit aware</span>
              <span class="chip">No-Nonsense JSON</span>
            </div>
            <h3>Preview the API</h3>
            <p>Hit the endpoint directly. Swap params and keep moving.</p>
            <pre class="code">
fetch("/api/gifs?character=gojo&amp;nsfw=false")
  .then(res =&gt; res.json())
  .then(data =&gt; console.log(data));</pre
            >
            <div class="chip-row" style="margin-top: 1rem">
              <span class="chip" style="color: var(--success)"
                >‚úì Own what you add</span
              >
              <span class="chip" style="color: var(--warning)"
                >üö´ Blacklist supported</span
              >
            </div>
          </div>
        </section>
        <section aria-labelledby="entry-points" class="section">
          <div class="notice">
            <div>
              <strong>New navigation:</strong> Portfolio lives under
              <code>/portfolio</code>. Everything here points you to the
              Linktree + GIF API tools.
            </div>
            <a class="btn ghost" href="/portfolio">Go to portfolio</a>
          </div>
        </section>
        <section aria-labelledby="paths" class="section">
          <div
            style="
              display: flex;
              align-items: center;
              gap: 0.6rem;
              flex-wrap: wrap;
              margin-bottom: 0.6rem;
            "
          >
            <h2 id="paths" style="margin: 0">Choose your path</h2>
            <span class="chip">Built for speed</span>
          </div>
          <p class="helper">
            Pick the surface you need. Everything stays dark, fast, and focused
            on shipping.
          </p>
          <div class="grid">
            <article class="card">
              <h3>GIF API Explorer</h3>
              <p>
                Query the Anime GIF API with instant previews and ready-to-copy
                requests.
              </p>
              <div class="chip-row">
                <span class="chip">Query builder</span>
                <span class="chip">cURL &amp; Python snippets</span>
                <span class="chip">Random &amp; filtered</span>
              </div>
              <a class="btn" href="/api">Open explorer</a>
            </article>
            <article class="card">
              <h3>Add &amp; manage GIFs</h3>
              <p>
                Submit new GIFs, tag characters, set NSFW flags, and keep the
                library clean.
              </p>
              <div class="chip-row">
                <span class="chip">Owner-only edits</span>
                <span class="chip">Admin moderation</span>
                <span class="chip">Character + tag search</span>
              </div>
              <a class="btn" href="/api/gif/admin">Add a GIF</a>
            </article>
            <article class="card">
              <h3>Linktree Builder</h3>
              <p>
                Create a personal landing page with media, icons, and effects
                that match your vibe.
              </p>
              <div class="chip-row">
                <span class="chip">Avatars &amp; backgrounds</span>
                <span class="chip">Music &amp; effects</span>
                <span class="chip">Icons &amp; ordering</span>
              </div>
              <a class="btn" href="/linktree/config">Configure Linktree</a>
            </article>
          </div>
        </section>
        <section aria-labelledby="why" class="section">
          <h2 id="why" style="margin: 0 0 0.4rem">Why these tools?</h2>
          <p class="helper">
            They're fast to try, easy to edit, and designed to be shared.
          </p>
          <div class="mini-grid">
            <div class="card">
              <h3>Quick onboarding</h3>
              <p>
                Open the explorer or Linktree editor‚Äîno docs hunt required.
                Inputs are labeled, guardrails included.
              </p>
            </div>
            <div class="card">
              <h3>Shareable by default</h3>
              <p>
                Copy API links, embed GIF URLs, or share your Linktree slug
                anywhere. Everything is HTTPS-ready.
              </p>
            </div>
            <div class="card">
              <h3>Community-friendly</h3>
              <p>
                GIF ownership, blacklists, and admin controls keep the library
                usable for everyone.
              </p>
            </div>
            <div class="card">
              <h3>Still want the portfolio?</h3>
              <p>
                It's one click away at
                <a
                  href="/portfolio"
                  style="color: inherit; text-decoration: underline"
                  >/portfolio</a
                >. You keep the context, but the landing stays focused on you.
              </p>
            </div>
          </div>
        </section>
      </div>
    </main>
    <script>
      const toggle = document.getElementById("mobileToggle");
      const menu = document.getElementById("primary-menu");
      toggle?.addEventListener("click", () => {
        const open = menu.classList.toggle("open");
        toggle.setAttribute("aria-expanded", String(open));
      });

      function escapeHtml(value) {
        const map = {
          "&": "&amp;",
          "<": "&lt;",
          ">": "&gt;",
          '"': "&quot;",
          "'": "&#39;",
        };
        return String(value ?? "").replace(/[&<>"']/g, (ch) => map[ch] || ch);
      }

      function sanitizeUrl(raw) {
        if (typeof raw !== "string") return "";
        const trimmed = raw.trim();
        if (!trimmed) return "";
        if (trimmed.startsWith("javascript:")) return "";
        try {
          const u = new URL(trimmed, window.location.origin);
          if (["http:", "https:"].includes(u.protocol)) {
            return trimmed.startsWith("http://") ||
              trimmed.startsWith("https://")
              ? u.href
              : trimmed;
          }
        } catch (_) {
          if (trimmed.startsWith("/") && !trimmed.startsWith("//"))
            return trimmed;
        }
        return "";
      }

      async function safe(fn) {
        try {
          return await fn();
        } catch (e) {
          console.error(e);
          return null;
        }
      }

      async function fetchSession() {
        try {
          const r = await safe(() =>
            fetch("/api/auth/verify", { credentials: "include" })
          );
          if (!r || !r.ok) return null;
          return await r.json();
        } catch {
          return null;
        }
      }

      async function renderAuthHeader() {
        const slot = document.getElementById("authSlot");
        if (!slot) return;

        const session = await fetchSession();
        const user = session && session.user ? session.user : null;
        const isAdmin = !!(user && user.admin);

        if (!user) {
          slot.innerHTML = `<a class="btn small" href="/login?next=${encodeURIComponent(
            location.href
          )}">Login</a>
      <a class="btn small" href="/register?next=${encodeURIComponent(
        location.href
      )}">Register</a>`;
          return;
        }

        const uname = user.username || "User";
        const initials = uname.trim().slice(0, 2).toUpperCase() || "U";
        const pfp = sanitizeUrl(user.profile_picture || "");

        slot.innerHTML = `
    <div class="auth-box">
      <button class="avatar-btn" id="avatarBtn" aria-haspopup="menu" aria-expanded="false">
        ${
          pfp
            ? `<img class="avatar" src="${pfp}" alt="${escapeHtml(
                uname
              )}'s profile picture">`
            : `<span class="avatar-fallback" aria-hidden="true">${escapeHtml(
                initials
              )}</span>`
        }
        <span class="uname" style="font-weight:700;font-size:.95rem">${escapeHtml(
          uname
        )}</span>
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <div class="menu" id="userMenu" role="menu" aria-label="User menu">
        <a href="/profile" role="menuitem">Profile</a>
        ${isAdmin ? `<a href="/admin" role="menuitem">Admin</a>` : ""}
        <button id="logoutBtnHdr" role="menuitem">Logout</button>
      </div>
    </div>`;

        const btn = slot.querySelector("#avatarBtn");
        const menu = slot.querySelector("#userMenu");
        const logoutBtn = slot.querySelector("#logoutBtnHdr");

        function closeMenu() {
          menu?.classList.remove("open");
          btn?.setAttribute("aria-expanded", "false");
        }

        btn?.addEventListener("click", (e) => {
          e.stopPropagation();
          const open = menu?.classList.toggle("open");
          btn.setAttribute("aria-expanded", String(open));
        });

        document.addEventListener("click", (e) => {
          if (
            menu &&
            !menu.contains(e.target) &&
            btn &&
            !btn.contains(e.target)
          ) {
            closeMenu();
          }
        });

        logoutBtn?.addEventListener(
          "click",
          async () => {
            try {
              await fetch("/api/auth/logout", {
                method: "POST",
                credentials: "include",
              });
            } catch {}
            location.href = "/";
          },
          { passive: true }
        );
      }

      renderAuthHeader();
    </script>
  </body>
</html>
